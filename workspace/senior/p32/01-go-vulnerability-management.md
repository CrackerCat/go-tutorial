# Go的全新漏洞检测工具govulncheck来了

## 前言

Go安全团队在2022.09.06发布了全新的漏洞检测工具`govulncheck`，可以帮助我们发现Go程序里的安全漏洞。

本文详细介绍该工具目前的现状以及接下来的功能规划。



## Go漏洞检测系统架构

![Architecture diagram of Go's vulnerability management system](./architecture.png)

上图是Go安全团队对于Go代码漏洞检测的系统架构图。

* 第1步，漏洞采集。Go安全团队会采集众多漏洞数据库，包括公开的漏洞数据库(例如[National Vulnerability Database (NVD)](https://nvd.nist.gov/)和 [GitHub Advisory Database](https://github.com/advisories))、社区反馈的[Go package漏洞]((https://go.dev/s/vulndb-report-new))以及Go团队修复过的安全漏洞等。
* 第2步：更新Go的漏洞数据库。对于第1步里收集到的安全漏洞，Go安全团队会出具评估报告，对报告的漏洞做评审，如果确认是需要处理的会进入到Go的漏洞数据库里。这些漏洞存储的按照 [Open Source Vulnerability (OSV) format](https://ossf.github.io/osv-schema/) 格式进行存储，并且可以通过[API](https://go.dev/security/vuln/database#api)获取到。
* 第3步：工具集成。对于新的漏洞处理后，会相应更新 [pkg.go.dev](https://pkg.go.dev/) 上的漏洞说明以及发布漏洞检测工具 [govulncheck](https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck)的新版本。`govulncheck`可以分析扫描你的代码仓库，只展示那些真正影响到你程序执行的漏洞。`govulncheck`工具非常可靠，很少误报，可以帮助你快速发现一些已知的安全漏洞。

## Go漏洞数据库

Go安全团队维护了一个漏洞数据库，地址是[https://vuln.go.dev](https://vuln.go.dev/)，也就是上面第2步所说的漏洞数据库。

* 如果你发现了新漏洞，可以通过这个[安全漏洞链接]((https://go.dev/s/vulndb-report-new))报告漏洞。
* 如果你认为已有的漏洞报告描述有问题，可以在这个[链接](https://go.dev/s/vulndb-report-feedback)进行反馈。

Go的漏洞数据库里包含的漏洞，可以在这个链接地址[pkg.go.dev/vuln](https://pkg.go.dev/vuln)进行查看。

## govulncheck

The new [govulncheck command](https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck) is a low-noise, reliable way for Go users to learn about known vulnerabilities that may affect their projects. Govulncheck analyzes your codebase and only surfaces vulnerabilities that actually affect you, based on which functions in your code are transitively calling vulnerable functions. To start using govulncheck, you can run the following from your project:

```
$ go install golang.org/x/vuln/cmd/govulncheck@latest
$ govulncheck ./...
```

Govulncheck is a standalone tool to allow frequent updates and rapid iteration while we gather feedback from users. In the long term, we plan to integrate the govulncheck tool into the main Go distribution.

To directly integrate vulnerability checking into other tools and processes, the [vulncheck](https://pkg.go.dev/golang.org/x/vuln/vulncheck) package exports govulncheck’s functionality as a Go API.

**备注**:

* `golang.org/x`下所有package的源码独立于Go源码的主干分支，也不在Go的二进制安装包里。如果需要使用`golang.org/x`下的package，可以使用`go get`来安装。
* `golang.org/x/exp`下的所有package都属于实验性质或者被废弃的package，不建议使用。

### Integrations

It’s always better to learn about vulnerabilities as early as possible in the development and deployment process. To that end, we have integrated vulnerability detection into existing Go tools and services, such as the [Go package discovery site](https://pkg.go.dev/). For example, [this page](https://pkg.go.dev/golang.org/x/text?tab=versions) shows the known vulnerabilities in each version of golang.org/x/text. Vulnerability checking functionality through the VS Code Go extension is also coming soon.

## Next Steps

We hope you’ll find Go’s support for vulnerability management useful and help us improve it!

Go’s support for vulnerability management is a new feature that is under active development. You should expect some bugs and [limitations](https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck#hdr-Limitations).

We would love for you to contribute and help us make improvements in the following ways:

- [Contribute new](https://golang.org/s/vulndb-report-new) and [update existing](https://go.dev/s/vulndb-report-feedback) information about public vulnerabilities for Go packages that you maintain
- [Take this survey](https://golang.org/s/govulncheck-feedback) to share your experience using govulncheck
- [Send us feedback](https://golang.org/s/vuln-feedback) about issues and feature requests

## 总结



## 开源地址

文章和示例代码开源在GitHub: [Go语言初级、中级和高级教程](https://github.com/jincheng9/go-tutorial)。

公众号：coding进阶。关注公众号可以获取最新Go面试题和技术栈。

个人网站：[Jincheng's Blog](https://jincheng9.github.io/)。

知乎：[无忌](https://www.zhihu.com/people/thucuhkwuji)。



## 福利

我为大家整理了一份后端开发学习资料礼包，包含编程语言入门到进阶知识(Go、C++、Python)、后端开发技术栈、面试题等。

关注公众号「coding进阶」，发送消息 **backend** 领取资料礼包，这份资料会不定期更新，加入我觉得有价值的资料。还可以发送消息「**进群**」，和同行一起交流学习，答疑解惑。



## References

* https://go.dev/blog/vuln
* https://go.dev/security/vuln/
* https://go.dev/security/vuln/database
* https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck